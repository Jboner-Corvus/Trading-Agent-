<!DOCTYPE html>
<html>
<head>
    <title>Validation Page Configuration</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .pending { background-color: #fff3cd; border-color: #ffeaa7; }
    </style>
</head>
<body>
    <h1>üîç Validation de la Page Configuration</h1>

    <div id="tests-container">
        <div class="test pending" id="test-frontend">Test: Frontend accessible...</div>
        <div class="test pending" id="test-backend">Test: Backend API accessible...</div>
        <div class="test pending" id="test-backtest-api">Test: API Backtests fonctionnelle...</div>
        <div class="test pending" id="test-title">Test: Titre modifi√© correctement...</div>
        <div class="test pending" id="test-functions">Test: Fonctions JavaScript pr√©sentes...</div>
        <div class="test pending" id="test-content">Test: Contenu syst√®me pr√©sent...</div>
    </div>

    <div style="margin-top: 30px;">
        <h3>R√©sultats de validation:</h3>
        <div id="validation-results"></div>
    </div>

    <script>
        async function runTests() {
            let results = [];

            // Test 1: Frontend accessible
            try {
                const response = await fetch('http://localhost:9001/config.html');
                if (response.ok) {
                    document.getElementById('test-frontend').className = 'test success';
                    document.getElementById('test-frontend').innerHTML = '‚úÖ Frontend accessible (HTTP 200)';
                    results.push('Frontend: OK');
                } else {
                    throw new Error('HTTP ' + response.status);
                }
            } catch (error) {
                document.getElementById('test-frontend').className = 'test error';
                document.getElementById('test-frontend').innerHTML = '‚ùå Frontend inaccessible: ' + error.message;
                results.push('Frontend: ERROR');
            }

            // Test 2: Backend API accessible
            try {
                const response = await fetch('http://localhost:7000/api/health');
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('test-backend').className = 'test success';
                    document.getElementById('test-backend').innerHTML = '‚úÖ Backend API accessible - Status: ' + data.status;
                    results.push('Backend API: OK');
                } else {
                    throw new Error('HTTP ' + response.status);
                }
            } catch (error) {
                document.getElementById('test-backend').className = 'test error';
                document.getElementById('test-backend').innerHTML = '‚ùå Backend API inaccessible: ' + error.message;
                results.push('Backend API: ERROR');
            }

            // Test 3: API Backtests fonctionnelle
            try {
                const response = await fetch('http://localhost:7000/api/backtests');
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('test-backtest-api').className = 'test success';
                    document.getElementById('test-backtest-api').innerHTML = '‚úÖ API Backtests fonctionnelle - ' + data.total_count + ' backtests trouv√©s';
                    results.push('API Backtests: OK');
                } else {
                    throw new Error('HTTP ' + response.status);
                }
            } catch (error) {
                document.getElementById('test-backtest-api').className = 'test error';
                document.getElementById('test-backtest-api').innerHTML = '‚ùå API Backtests inaccessible: ' + error.message;
                results.push('API Backtests: ERROR');
            }

            // Test 4: V√©rifier le contenu HTML
            try {
                const response = await fetch('http://localhost:9001/config.html');
                const html = await response.text();

                // V√©rifier que le titre a √©t√© modifi√©
                if (html.includes('√âtat du Syst√®me</h2>') && !html.includes('√âtat du Syst√®me Backtest</h2>')) {
                    document.getElementById('test-title').className = 'test success';
                    document.getElementById('test-title').innerHTML = '‚úÖ Titre modifi√© correctement (plus de "Backtest")';
                    results.push('Titre: OK');
                } else {
                    document.getElementById('test-title').className = 'test error';
                    document.getElementById('test-title').innerHTML = '‚ùå Titre non modifi√© correctement';
                    results.push('Titre: ERROR');
                }

                // V√©rifier que les fonctions JavaScript sont pr√©sentes
                if (html.includes('refreshSystemStatus') && html.includes('testConnections')) {
                    document.getElementById('test-functions').className = 'test success';
                    document.getElementById('test-functions').innerHTML = '‚úÖ Fonctions JavaScript pr√©sentes';
                    results.push('Fonctions JS: OK');
                } else {
                    document.getElementById('test-functions').className = 'test error';
                    document.getElementById('test-functions').innerHTML = '‚ùå Fonctions JavaScript manquantes';
                    results.push('Fonctions JS: ERROR');
                }

                // V√©rifier que le contenu syst√®me est pr√©sent
                if (html.includes('system-overview') && html.includes('status-grid')) {
                    document.getElementById('test-content').className = 'test success';
                    document.getElementById('test-content').innerHTML = '‚úÖ Contenu syst√®me am√©lior√© pr√©sent';
                    results.push('Contenu syst√®me: OK');
                } else {
                    document.getElementById('test-content').className = 'test error';
                    document.getElementById('test-content').innerHTML = '‚ùå Contenu syst√®me manquant';
                    results.push('Contenu syst√®me: ERROR');
                }

            } catch (error) {
                document.getElementById('test-title').className = 'test error';
                document.getElementById('test-title').innerHTML = '‚ùå Erreur lors de la v√©rification du contenu: ' + error.message;
                results.push('Contenu: ERROR');
            }

            // Afficher le r√©sum√©
            const successCount = results.filter(r => r.includes('OK')).length;
            const totalCount = results.length;

            document.getElementById('validation-results').innerHTML = `
                <div style="padding: 15px; background: ${successCount === totalCount ? '#d4edda' : '#fff3cd'}; border-radius: 5px;">
                    <h4>üéØ R√©sultat: ${successCount}/${totalCount} tests r√©ussis</h4>
                    <ul>${results.map(r => `<li>${r}</li>`).join('')}</ul>
                    <p><strong>Page Configuration: ${successCount === totalCount ? '‚úÖ VALID√âE' : '‚ö†Ô∏è PARTIELLEMENT VALID√âE'}</strong></p>
                    <p><a href="http://localhost:9001/config.html" target="_blank">üîó Ouvrir la page configuration</a></p>
                </div>
            `;
        }

        // Lancer les tests au chargement de la page
        window.onload = runTests;
    </script>
</body>
</html>